# CAP theorem ("Си-Эй-Пи" или "КАП" теорема)


**CAP-теорема** (от англ. Consistency, Availability, Partition Tolerance) — это принцип, описывающий ограничения распределённых систем, предложенный Эриком Брюером в 2000 году. Её суть заключается в том, что в любой распределённой системе одновременно можно достичь только двух из трёх свойств:

- **Consistency (Согласованность)**
    - Все узлы системы всегда имеют одинаковые данные. Когда клиент читает данные, он всегда получает последнюю, самую актуальную версию.


- **Availability (Доступность)**
    - Система всегда отвечает на запросы, даже если часть узлов не работает. Это означает, что каждый запрос к системе завершается успешным ответом (хотя данные могут быть не полностью актуальными).


- **Partition Tolerance (Устойчивость к разделению)**
    - Система продолжает работать, даже если связь между узлами разорвана (например, из-за сетевых проблем). Узлы могут работать независимо, несмотря на разделение.


## Ограничение теоремы:

Согласно **CAP-теореме**, нельзя одновременно гарантировать все три свойства в условиях сетевых разделений (а они неизбежны). Поэтому любая распределённая система вынуждена выбирать два из трёх:

- **CP (Consistency + Partition Tolerance)**
    - Гарантируется согласованность и устойчивость к разделению, но доступность может временно пострадать.
  
    *Пример: MongoDB (с write concern: majority), HBase.*


- **AP (Availability + Partition Tolerance)**
    - Система остаётся доступной, несмотря на разделение, но согласованность может быть нарушена.
  
    *Пример: Cassandra, DynamoDB.*


- **CA (Consistency + Availability)**
    - Гарантируется согласованность и доступность, но система не устойчива к разделению. Такое возможно только в системах, где нет сетевых разделений (централизованные базы данных).
  
    *Пример: реляционные базы данных (например, MySQL без репликации).*


## Почему это важно?

CAP-теорема помогает выбрать правильную архитектуру базы данных или системы в зависимости от требований. Например:

- Если важна доступность и устойчивость к сбоям сети (но можно пожертвовать согласованностью), подходят базы вроде Cassandra (noSQL база данных).

- Если ключевым требованием является согласованность данных, но допустимы задержки в доступе, стоит выбрать базы вроде MongoDB с настройкой Write Concern.



## ACID

*ACID* - это набор характеристик, обеспечивающих надёжность и целостность транзакций в БД:

- *Atomicity* (атомарность) — либо всё, либо ничего.
- *Consistency* (согласованность) — данные остаются корректными.
- *Isolation* (изолированность) — транзакции не мешают друг другу.
- *Durability* (надёжность) — данные сохраняются даже при сбоях.
