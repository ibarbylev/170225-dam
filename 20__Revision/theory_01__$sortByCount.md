Оператор `$sortByCount` в MongoDB используется для подсчета количества уникальных значений в поле и одновременной сортировки результатов по убыванию этого количества. Это сочетание `$group` и `$sort`, объединенное в один шаг для упрощения выполнения задачи.

-

### Пример: Поле `Album_type`

Предположим, в нашей коллекции `albums` есть поле `Album_type`, и мы хотим узнать, сколько альбомов каждого типа существует, отсортировав их по убыванию количества.

```
db.albums.aggregate([
  { $sortByCount: "$Album_type" }
]);
```


```json
[
  { "_id": "Studio", "count": 45 },
  { "_id": "Live", "count": 30 },
  { "_id": "Compilation", "count": 20 }
]
```

То же самое с использованием `$group` и `$sort`

```
db.albums.aggregate([
  { 
    $group: {
      _id: "$Album_type",
      count: { $sum: 1 }
    }
  },
  { 
    $sort: { count: -1 } 
  }
]);
```

**Результат:** идентичен `$sortByCount`.


### Когда что использовать

- **Используйте `$sortByCount`**, если вам нужно быстро подсчитать количество уникальных значений и отсортировать их.
- **Используйте `$group` и `$sort`**, если необходима дополнительная